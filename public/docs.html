<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion HomeTree - Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
            line-height: 1.6;
            color: rgb(55, 53, 47);
            background: #fafafa;
        }

        .docs-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }

        .header h1 {
            font-size: 2.5rem;
            color: rgb(55, 53, 47);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            color: rgb(120, 119, 116);
        }

        .nav-links {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .nav-links a {
            padding: 8px 16px;
            background: rgb(46, 170, 220);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
            transition: background 0.15s ease;
        }

        .nav-links a:hover {
            background: rgb(35, 150, 200);
        }

        .section {
            background: white;
            margin: 30px 0;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .section h2 {
            color: rgb(55, 53, 47);
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e9ecef;
        }

        .section h3 {
            color: rgb(55, 53, 47);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        .section ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .section li {
            margin-bottom: 5px;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .inline-code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9em;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid rgb(46, 170, 220);
        }

        .feature-card h4 {
            color: rgb(55, 53, 47);
            margin-bottom: 10px;
        }

        .api-endpoint {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid rgb(46, 170, 220);
        }

        .api-endpoint .method {
            font-weight: bold;
            color: rgb(46, 170, 220);
        }

        .api-endpoint .path {
            font-family: 'Monaco', 'Consolas', monospace;
            background: rgba(46, 170, 220, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            margin: 0 10px;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
        }

        .toc h3 {
            margin-top: 0;
        }

        .toc ul {
            list-style-type: none;
            margin-left: 0;
        }

        .toc a {
            color: rgb(46, 170, 220);
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="docs-container">
        <div class="header">
            <h1>üìö Notion HomeTree Documentation</h1>
            <p>Complete guide to setting up and using embeddable Notion tree structures</p>
            
            <div class="nav-links">
                <a href="/">‚Üê Back to Config</a>
                <a href="/test">Test Page</a>
                <a href="/health">Health Check</a>
                <a href="https://github.com/your-username/notion-hometree" target="_blank">GitHub</a>
            </div>
        </div>

        <div class="toc">
            <h3>üìã Table of Contents</h3>
            <ul>
                <li><a href="#getting-started">Getting Started</a></li>
                <li><a href="#features">Features & Capabilities</a></li>
                <li><a href="#embed-configuration">Embed Configuration</a></li>
                <li><a href="#dynamic-configuration">Dynamic Configuration</a></li>
                <li><a href="#api-reference">API Reference</a></li>
                <li><a href="#hosting">Hosting & Deployment</a></li>
                <li><a href="#troubleshooting">Troubleshooting</a></li>
            </ul>
        </div>

        <div id="getting-started" class="section">
            <h2>üöÄ Getting Started</h2>
            
            <h3>What is Notion HomeTree?</h3>
            <p>Notion HomeTree creates embeddable tree-like directory structures that can be added directly to Notion pages as blocks. Think of it like adding a table or calendar - but for visualizing your page hierarchy.</p>

            <div class="success">
                <strong>üÜï New:</strong> Dynamic configuration allows you to start with an empty embed and build your tree by adding pages on-the-fly using the + button!
            </div>

            <h3>Quick Setup</h3>
            <ol>
                <li><strong>Clone & Install:</strong>
                    <div class="code-block">git clone https://github.com/your-username/notion-hometree
cd notion-hometree
npm install</div>
                </li>
                <li><strong>Configure Notion API:</strong>
                    <ul>
                        <li>Create integration at <a href="https://www.notion.so/my-integrations" target="_blank">notion.so/my-integrations</a></li>
                        <li>Copy integration token</li>
                        <li>Create <span class="inline-code">.env</span> file with token</li>
                    </ul>
                </li>
                <li><strong>Start Server:</strong>
                    <div class="code-block">npm run dev</div>
                </li>
                <li><strong>Generate Embed:</strong>
                    <ul>
                        <li>Visit <span class="inline-code">http://localhost:3000</span></li>
                        <li>Configure your tree settings</li>
                        <li>Copy the embed URL</li>
                    </ul>
                </li>
                <li><strong>Add to Notion:</strong>
                    <ul>
                        <li>In Notion, type <span class="inline-code">/embed</span></li>
                        <li>Paste your embed URL</li>
                        <li>Press Enter - your tree appears!</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div id="features" class="section">
            <h2>‚ú® Features & Capabilities</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üîó Clickable Links</h4>
                    <p>Each tree node links directly to the Notion page, opening in a new tab for easy navigation.</p>
                </div>
                
                <div class="feature-card">
                    <h4>üîç Smart Search</h4>
                    <p>Real-time search with highlighting. Filter or highlight matching content as you type.</p>
                </div>
                
                <div class="feature-card">
                    <h4>üì± Responsive Design</h4>
                    <p>Compact and full view modes. Auto-resizing to fit content. Mobile-friendly interface.</p>
                </div>
                
                <div class="feature-card">
                    <h4>üîÑ Auto-Refresh</h4>
                    <p>Configurable auto-refresh rates. Manual refresh with state preservation. Cache management.</p>
                </div>
                
                <div class="feature-card">
                    <h4>üå≥ Multi-Root Trees</h4>
                    <p>Display multiple page hierarchies in a single unified tree view with virtual containers.</p>
                </div>
                
                <div class="feature-card">
                    <h4>‚ûï Dynamic Configuration</h4>
                    <p>Start empty and add pages dynamically. Modal interface for easy page addition.</p>
                </div>
            </div>
        </div>

        <div id="embed-configuration" class="section">
            <h2>‚öôÔ∏è Embed Configuration</h2>
            
            <h3>URL Parameters</h3>
            <p>Customize your embed using these URL parameters:</p>
            
            <div class="code-block">https://your-domain.com/embed?pageId=abc123&compact=true&showSearch=true</div>
            
            <ul>
                <li><span class="inline-code">pageId</span> - Single page ID to display</li>
                <li><span class="inline-code">pageIds</span> - Comma-separated multiple page IDs</li>
                <li><span class="inline-code">compact</span> - Use compact view (true/false)</li>
                <li><span class="inline-code">showSearch</span> - Show search box (true/false)</li>
                <li><span class="inline-code">maxDepth</span> - Maximum tree depth (number)</li>
                <li><span class="inline-code">autoExpand</span> - Auto-expand all nodes (true/false)</li>
                <li><span class="inline-code">autoRefresh</span> - Auto-refresh rate in seconds (0 = disabled)</li>
                <li><span class="inline-code">theme</span> - Color theme (light/dark)</li>
            </ul>

            <h3>Page ID Formats</h3>
            <p>The system supports multiple ways to specify pages:</p>
            <ul>
                <li><strong>Page ID:</strong> <span class="inline-code">32-character hex string</span></li>
                <li><strong>Full URL:</strong> <span class="inline-code">https://notion.so/workspace/Page-Title-abc123</span></li>
                <li><strong>Multiple Pages:</strong> <span class="inline-code">pageIds=id1,id2,id3</span></li>
            </ul>
        </div>

        <div id="dynamic-configuration" class="section">
            <h2>üîÑ Dynamic Configuration</h2>
            
            <h3>Empty State Initialization</h3>
            <p>Create an embed without any initial pages:</p>
            <div class="code-block">https://your-domain.com/embed?compact=true</div>
            <p>This will show an empty state with a + button to add pages dynamically.</p>
            
            <h3>Default Page Configuration</h3>
            <p>Set default pages that load when no URL parameters are provided:</p>
            <div class="code-block"># In .env file
DEFAULT_PAGE_IDS=page1,page2,page3</div>
            
            <h3>Adding Pages Dynamically</h3>
            <ol>
                <li>Click the <strong>+ Add Page</strong> button at the bottom of the tree</li>
                <li>Paste Notion page URLs (one per line for multiple pages)</li>
                <li>Click <strong>Add Page(s)</strong></li>
                <li>The tree automatically updates with new pages</li>
            </ol>
            
            <h3>Supported URL Formats</h3>
            <p>The dynamic system can parse these Notion URL formats:</p>
            <ul>
                <li><span class="inline-code">https://notion.so/abc123</span></li>
                <li><span class="inline-code">https://notion.so/Page-Title-abc123</span></li>
                <li><span class="inline-code">https://notion.so/workspace/Page-Title-abc123?source=copy_link</span></li>
                <li><span class="inline-code">abc123def456...</span> (direct page ID)</li>
            </ul>
        </div>

        <div id="api-reference" class="section">
            <h2>üîó API Reference</h2>
            
            <div class="api-endpoint">
                <span class="method">GET</span><span class="path">/api/tree/:pageId</span>
                <p>Fetch tree structure for a page. Supports comma-separated page IDs for multi-root trees.</p>
            </div>
            
            <div class="api-endpoint">
                <span class="method">GET</span><span class="path">/api/config/defaults</span>
                <p>Get default configuration from server environment variables.</p>
            </div>
            
            <div class="api-endpoint">
                <span class="method">GET</span><span class="path">/api/cache/stats</span>
                <p>Get cache statistics including hit rates and stored key count.</p>
            </div>
            
            <div class="api-endpoint">
                <span class="method">POST</span><span class="path">/api/cache/clear/:pageId?</span>
                <p>Clear cache for specific page or all cached data.</p>
            </div>
            
            <div class="api-endpoint">
                <span class="method">GET</span><span class="path">/health</span>
                <p>Server health check with endpoint information and cache stats.</p>
            </div>

            <h3>Response Format</h3>
            <p>Tree API returns hierarchical JSON structure:</p>
            <div class="code-block">{
  "id": "page-id",
  "title": "Page Title", 
  "type": "page|database|virtual",
  "children": [
    // ... nested pages
  ]
}</div>
        </div>

        <div id="hosting" class="section">
            <h2>üåê Hosting & Deployment</h2>
            
            <h3>Railway (Recommended)</h3>
            <ol>
                <li>Push code to GitHub</li>
                <li>Connect repository on <a href="https://railway.app" target="_blank">railway.app</a></li>
                <li>Add environment variables in dashboard</li>
                <li>Deploy automatically</li>
            </ol>
            
            <h3>Environment Variables</h3>
            <p>Configure these variables on your hosting platform:</p>
            <div class="code-block"># Required
NOTION_API_KEY=your_notion_integration_token

# Optional  
DEFAULT_PAGE_IDS=page1,page2,page3
CACHE_TTL=300
AUTO_REFRESH_DEFAULT=0
MAX_DEPTH_DEFAULT=3</div>
            
            <h3>Other Platforms</h3>
            <ul>
                <li><strong>Heroku:</strong> Use Heroku CLI with <span class="inline-code">git push heroku main</span></li>
                <li><strong>Vercel:</strong> Deploy with <span class="inline-code">vercel --prod</span></li>
                <li><strong>Render:</strong> Connect GitHub repository</li>
                <li><strong>Docker:</strong> Use provided Dockerfile for containerization</li>
            </ul>
            
            <div class="warning">
                <strong>‚ö†Ô∏è Security Note:</strong> Never commit your <span class="inline-code">NOTION_API_KEY</span> to version control. Always use environment variables.
            </div>
        </div>

        <div id="troubleshooting" class="section">
            <h2>üîß Troubleshooting</h2>
            
            <h3>Common Issues</h3>
            
            <h4>‚ùå "Page ID is required" Error</h4>
            <ul>
                <li>Ensure you've shared the page with your Notion integration</li>
                <li>Check that the page ID is correctly formatted (32 hex characters)</li>
                <li>Verify your <span class="inline-code">NOTION_API_KEY</span> is set correctly</li>
            </ul>
            
            <h4>üîÑ Embed Not Loading</h4>
            <ul>
                <li>Check browser console for CORS errors</li>
                <li>Verify server is running and accessible</li>
                <li>Test with <span class="inline-code">/health</span> endpoint</li>
            </ul>
            
            <h4>‚ûï Add Page Button Not Working</h4>
            <ul>
                <li>Ensure JavaScript is enabled</li>
                <li>Check browser console for modal errors</li>
                <li>Verify URL parsing with test URLs</li>
            </ul>
            
            <h3>Debug Tools</h3>
            <ul>
                <li><strong>Test Page:</strong> <span class="inline-code">/test</span> - Comprehensive testing interface</li>
                <li><strong>Health Check:</strong> <span class="inline-code">/health</span> - Server status and endpoints</li>
                <li><strong>Cache Stats:</strong> <span class="inline-code">/api/cache/stats</span> - Performance monitoring</li>
                <li><strong>Mock Data:</strong> Use <span class="inline-code">pageId=mock</span> for testing without API</li>
            </ul>
            
            <h3>Performance Optimization</h3>
            <ul>
                <li>Adjust <span class="inline-code">CACHE_TTL</span> for your update frequency needs</li>
                <li>Use <span class="inline-code">maxDepth</span> parameter to limit tree depth</li>
                <li>Enable <span class="inline-code">compact</span> mode for smaller embeds</li>
                <li>Monitor cache hit rates with <span class="inline-code">/api/cache/stats</span></li>
            </ul>
        </div>

        <div class="section">
            <h2>ü§ù Support & Contributing</h2>
            
            <p>Need help or want to contribute?</p>
            <ul>
                <li>üìñ <a href="/">Configuration Interface</a></li>
                <li>üß™ <a href="/test">Test Your Setup</a></li>
                <li>üíª <a href="https://github.com/your-username/notion-hometree" target="_blank">GitHub Repository</a></li>
                <li>üêõ <a href="https://github.com/your-username/notion-hometree/issues" target="_blank">Report Issues</a></li>
            </ul>
            
            <div class="success">
                <strong>‚ú® Pro Tip:</strong> Start with the test page to validate your setup before deploying to production!
            </div>
        </div>
    </div>
</body>
</html>